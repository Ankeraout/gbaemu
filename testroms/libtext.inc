libtext_fontData:
    db 0x7c, 0xc6, 0xce, 0xde, 0xf6, 0xe6, 0x7c, 0x00 ; 0
    db 0x30, 0x70, 0x30, 0x30, 0x30, 0x30, 0xfc, 0x00 ; 1
    db 0x78, 0xcc, 0x0c, 0x38, 0x60, 0xcc, 0xfc, 0x00 ; 2
    db 0x78, 0xcc, 0x0c, 0x38, 0x0c, 0xcc, 0x78, 0x00 ; 3
    db 0x1c, 0x3c, 0x6c, 0xcc, 0xfe, 0x0c, 0x1e, 0x00 ; 4
    db 0xfc, 0xc0, 0xf8, 0x0c, 0x0c, 0xcc, 0x78, 0x00 ; 5
    db 0x38, 0x60, 0xc0, 0xf8, 0xcc, 0xcc, 0x78, 0x00 ; 6
    db 0xfc, 0xcc, 0x0c, 0x18, 0x30, 0x30, 0x30, 0x00 ; 7
    db 0x78, 0xcc, 0xcc, 0x78, 0xcc, 0xcc, 0x78, 0x00 ; 8
    db 0x78, 0xcc, 0xcc, 0x7c, 0x0c, 0x18, 0x70, 0x00 ; 9
    db 0x30, 0x78, 0xcc, 0xcc, 0xfc, 0xcc, 0xcc, 0x00 ; A
    db 0xfc, 0x66, 0x66, 0x7c, 0x66, 0x66, 0xfc, 0x00 ; B
    db 0x3c, 0x66, 0xc0, 0xc0, 0xc0, 0x66, 0x3c, 0x00 ; C
    db 0xf8, 0x6c, 0x66, 0x66, 0x66, 0x6c, 0xf8, 0x00 ; D
    db 0xfe, 0x62, 0x68, 0x78, 0x68, 0x62, 0xfe, 0x00 ; E
    db 0xfe, 0x62, 0x68, 0x78, 0x68, 0x60, 0xf0, 0x00 ; F

libtext_init:
    push {r0, r1}
    
    mov r0, 0x04000000
    mov r1, 0x00000400
    orr r1, 0x00000003
    strh r1, [r0]

    pop {r0, r1}
    bx r14

; args:
; r0 - x
; r1 - y
; r2 - value to print
libtext_putHex:
    push {r0-r3, r14}

    mov r3, r2
    lsr r2, r3, 28
    bl libhex_putChar
    add r0, 8
    lsr r2, r3, 24
    bl libhex_putChar
    add r0, 8
    lsr r2, r3, 20
    bl libhex_putChar
    add r0, 8
    lsr r2, r3, 16
    bl libhex_putChar
    add r0, 8
    lsr r2, r3, 12
    bl libhex_putChar
    add r0, 8
    lsr r2, r3, 8
    bl libhex_putChar
    add r0, 8
    lsr r2, r3, 4
    bl libhex_putChar
    add r0, 8
    mov r2, r3
    bl libhex_putChar

    pop {r0-r3, r14}
    bx r14

; args:
; r0 - x
; r1 - y
; r2 - char
;
; allocated:
; r3 - vram ptr
; r4 - font ptr
; r5 - font value
; r6 - r5 and 1
libhex_putChar:
    push {r0-r6}

    mov r3, r1
    mov r4, 0
    mov r5, 480
    umull r3, r4, r1, r5
    add r3, r0, lsl 1
    orr r3, 0x06000000

    adr r4, libtext_fontData
    and r2, 0x0000000f
    add r4, r2, lsl 3
    
    mov r1, 0 ; y

libhex_putChar_loop0:
    ldrb r5, [r4]
    add r4, 1
    mov r0, 0

libhex_putChar_loop1:
    ands r6, r5, 0x80
    movne r6, 0x00007f00
    orrne r6, 0x000000ff
    moveq r6, 0x00000000
    lsl r5, 1
    strhne r6, [r3]
    add r3, 2
    add r0, 1
    cmp r0, 8
    bne libhex_putChar_loop1

    add r3, 464
    add r1, 1
    cmp r1, 8
    bne libhex_putChar_loop0

    pop {r0-r6}
    bx r14
